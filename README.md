# Диспетчер задач (Task Manager)

Программа на C++ для мониторинга и управления процессами, аналогичная стандартному диспетчеру задач Windows.

## Возможности

- Просмотр списка запущенных процессов
- Мониторинг использования CPU и памяти
- Завершение процессов
- Запуск новых процессов
- Обновление информации в реальном времени

## Требования

- Windows 7/8/10/11
- Visual Studio 2022
- CMake 3.10 или выше (для генерации проекта)

## Сборка проекта

### Вариант 1: С использованием CMake

1. Создайте директорию для сборки:
   ```
   mkdir build
   cd build
   ```

2. Сгенерируйте файлы проекта для Visual Studio:
   ```
   cmake -G "Visual Studio 17 2022" ..
   ```

3. Откройте сгенерированный файл проекта `.sln` в Visual Studio 2022 и выполните сборку.

### Вариант 2: Напрямую через Visual Studio

1. Откройте Visual Studio 2022
2. Выберите "Открыть CMake"
3. Выберите файл CMakeLists.txt из корневой директории проекта
4. Visual Studio автоматически сконфигурирует проект
5. Нажмите Ctrl+B для сборки проекта

## Использование

После запуска программы вы увидите главное меню с возможными действиями:

1. Показать список процессов
2. Показать информацию о производительности
3. Завершить процесс
4. Запустить новый процесс
5. Обновить данные
0. Выход

Используйте клавиши с цифрами для выбора нужного пункта меню.

## Подробное описание файлов проекта

### 1. TaskManagerUI.cpp
Основной файл пользовательского интерфейса. Содержит:
- Реализацию главного окна приложения
- Обработку пользовательского ввода
- Отображение списка процессов
- Графический интерфейс для мониторинга CPU и памяти
- Функции обновления данных в реальном времени
- Обработчики событий для кнопок управления

### 2. TaskManagerUI.h
Заголовочный файл для TaskManagerUI.cpp. Определяет:
- Класс TaskManagerUI
- Структуры данных для хранения информации о процессах
- Прототипы методов для работы с GUI
- Константы и макросы для интерфейса

### 3. TaskManagerUI_new.cpp
Обновленная версия интерфейса с дополнительными функциями:
- Улучшенный дизайн интерфейса
- Дополнительные метрики производительности
- Оптимизированное обновление данных
- Расширенные возможности фильтрации процессов

### 4. ProcessManager.cpp
Реализация управления процессами. Содержит:
- Функции для получения списка процессов
- Методы для завершения процессов
- Запуск новых процессов
- Получение информации об использовании CPU и памяти
- Работа с приоритетами процессов

### 5. ProcessManager.h
Заголовочный файл для ProcessManager.cpp. Определяет:
- Класс ProcessManager
- Структуры для хранения информации о процессах
- Прототипы методов управления процессами
- Константы для работы с процессами

### 6. ProcessInfo.h
Определения структур данных для хранения информации о процессах:
- Структура ProcessData для хранения метрик процесса
- Класс ProcessMetrics для работы с производительностью
- Вспомогательные структуры для сортировки и фильтрации

### 7. TaskManager.cpp
Точка входа в программу. Содержит:
- Функцию main()
- Инициализацию приложения
- Создание главного окна
- Обработку аргументов командной строки

### 8. CMakeLists.txt
Файл конфигурации сборки проекта. Определяет:
- Настройки компилятора
- Зависимости проекта
- Цели сборки
- Опции компиляции

## Структура проекта и используемые библиотеки

### Основные компоненты:

1. **TaskManagerUI** (`TaskManagerUI.cpp`, `TaskManagerUI.h`)
   - Реализация пользовательского интерфейса
   - Использует Windows API для создания GUI
   - Обработка пользовательского ввода и отображение данных

2. **ProcessManager** (`ProcessManager.cpp`, `ProcessManager.h`)
   - Управление процессами
   - Использует Windows API (psapi.h, tlhelp32.h)
   - Функции для получения информации о процессах и их управления

3. **ProcessInfo** (`ProcessInfo.h`)
   - Структуры данных для хранения информации о процессах
   - Определение классов и структур для работы с метриками процессов

### Используемые библиотеки:

1. **Windows API**
   - `windows.h` - основной заголовочный файл Windows API
   - `psapi.h` - для работы с процессами и их метриками
   - `tlhelp32.h` - для создания снимков процессов
   - `winuser.h` - для работы с GUI

2. **Стандартная библиотека C++**
   - `<vector>` - для хранения списков процессов
   - `<string>` - для работы со строками
   - `<iostream>` - для ввода/вывода
   - `<chrono>` - для работы со временем
   - `<thread>` - для многопоточности

3. **CMake**
   - Для управления сборкой проекта
   - Настройка компиляции и линковки

### Дополнительные зависимости:

- Visual Studio 2022 с поддержкой C++17
- Windows SDK последней версии
- CMake 3.10 или выше

## Примечания

- Для завершения некоторых системных процессов может потребоваться запуск программы с правами администратора.
- При запуске новых процессов можно указывать как полный путь, так и имя исполняемого файла, находящегося в PATH.

## Подробное описание функций и компонентов

### 1. Класс TaskManagerUI

#### Основные публичные функции:
- `TaskManagerUI()` - конструктор
- `~TaskManagerUI()` - деструктор
- `void Run()` - запуск приложения
- `void RefreshProcessList()` - обновление списка процессов
- `std::wstring FormatMemorySize(SIZE_T size)` - форматирование размера памяти
- `void InitializeUI()` - инициализация пользовательского интерфейса

#### Приватные функции:
1. **Управление окнами:**
   - `bool InitWindow()` - инициализация окна
   - `void RegisterWindowClass(HINSTANCE hInstance)` - регистрация класса окна
   - `HWND CreateMainWindow(HINSTANCE hInstance)` - создание главного окна
   - `void InitializeMenu()` - инициализация меню
   - `void InitializeListView()` - инициализация списка процессов
   - `void InitializeStatusBar()` - инициализация строки состояния

2. **Обработка сообщений:**
   - `static LRESULT CALLBACK WindowProc()` - обработчик сообщений окна
   - `LRESULT HandleMessage()` - обработка сообщений
   - `void HandleCommand(int commandId)` - обработка команд меню

3. **Обновление интерфейса:**
   - `void UpdateStatusBar()` - обновление строки состояния
   - `void UpdatePerformanceData()` - обновление данных о производительности

4. **Отрисовка графиков:**
   - `void DrawCpuGraph()` - отрисовка графика CPU
   - `void DrawMemGraph()` - отрисовка графика памяти
   - `void DrawNetworkGraph()` - отрисовка графика сети
   - `void DrawCpuBarGraph()` - отрисовка столбчатого графика CPU
   - `void DrawMemBarGraph()` - отрисовка столбчатого графика памяти
   - `void DrawNetworkBarGraph()` - отрисовка столбчатого графика сети

5. **Диалоговые окна:**
   - `void ShowTerminateProcessDialog()` - диалог завершения процесса
   - `void ShowStartProcessDialog()` - диалог запуска процесса
   - `void ShowPerformanceDialog()` - диалог производительности

6. **Утилиты:**
   - `void SetProcessListColumns()` - настройка колонок списка процессов
   - `void AddProcessToListView()` - добавление процесса в список
   - `void SortAndRefreshProcessList()` - сортировка и обновление списка

### 2. Класс ProcessManager

#### Публичные функции:
- `ProcessManager()` - конструктор
- `~ProcessManager()` - деструктор
- `void UpdateProcessList()` - обновление списка процессов
- `const std::vector<ProcessInfo>& GetProcesses()` - получение списка процессов
- `bool TerminateProcess(DWORD processId)` - завершение процесса
- `bool StartNewProcess(const std::wstring& processPath)` - запуск нового процесса
- `double GetSystemCpuUsage()` - получение загрузки CPU
- `SIZE_T GetSystemMemoryInfo()` - получение информации о памяти
- `SystemInfo GetSystemInfo()` - получение системной информации
- `std::wstring GetProcessStatus(DWORD processId)` - получение статуса процесса

#### Приватные функции:
- `void UpdateCpuUsage()` - обновление загрузки CPU
- `double CalculateCpuUsage()` - расчет загрузки CPU для процесса

### 3. Структуры данных

#### ProcessInfo:
- `DWORD pid` - идентификатор процесса
- `std::wstring name` - имя процесса
- `DWORD parentPid` - идентификатор родительского процесса
- `SIZE_T memoryUsage` - использование памяти
- `double cpuUsage` - использование CPU
- `std::wstring status` - статус процесса
- `ULONGLONG workingSetSize` - размер рабочего набора

#### SystemInfo:
- `double cpuUsage` - загрузка CPU
- `double memoryUsagePercent` - процент использования памяти
- `SIZE_T totalMemory` - общий объем памяти
- `SIZE_T memoryUsed` - используемая память
- `SIZE_T memoryAvailable` - доступная память
- `double networkSendSpeedKBps` - скорость отправки по сети
- `double networkReceiveSpeedKBps` - скорость приема по сети

#### PerformanceHistory:
- `std::deque<double> cpuHistory` - история загрузки CPU
- `std::deque<double> memHistory` - история использования памяти
- `std::deque<double> netSendHistory` - история отправки по сети
- `std::deque<double> netReceiveHistory` - история приема по сети
- `void AddData()` - добавление новых данных
- `void Clear()` - очистка истории

### 4. Диалоговые функции
- `TerminateProcessDialogProc()` - обработчик диалога завершения процесса
- `PerformanceDialogProc()` - обработчик диалога производительности

### 5. Утилиты
- `LogDebugMessage()` - функция логирования отладочных сообщений

## Лицензия

Этот проект распространяется под лицензией MIT. 